<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Stube's Studio</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, Arial, sans-serif;
  background: #0d0d0d;
  color: #fff;
  text-align: center;
}

header {
  padding: 15px;
  font-size: 22px;
  font-weight: bold;
  border-bottom: 1px solid #222;
}

.drink {
  margin: 22px auto;
}

button {
  width: 85%;
  padding: 14px;
  font-size: 16px;
  background: #1db954;
  border: none;
  border-radius: 6px;
  color: #000;
}

button:active { opacity: 0.8; }

.info {
  font-size: 13px;
  color: #aaa;
  margin-top: 4px;
}

.admin {
  margin-top: 140px;
  padding: 20px 10px;
  background: #111;
  border-top: 1px solid #222;
}

.admin h2 {
  font-size: 18px;
  margin-bottom: 10px;
}

.admin input, .admin select {
  width: 85%;
  padding: 10px;
  margin-bottom: 10px;
  font-size: 14px;
  background: #000;
  border: 1px solid #333;
  color: #fff;
  border-radius: 4px;
}

.admin button {
  background: #ff5252;
  color: #000;
}

.hidden { display: none; }

.statsBox {
  margin-top: 15px;
  font-size: 14px;
}

.log {
  margin-top: 10px;
  font-size: 12px;
  text-align: left;
  max-height: 160px;
  overflow-y: auto;
  border-top: 1px solid #222;
  padding-top: 8px;
  color: #ccc;
}
</style>
</head>

<body>

<header>Stube's Studio</header>

<div class="drink">
  <button onclick="eroga('monster')">Monster</button>
  <div class="info" id="monsterInfo"></div>
</div>

<div class="drink">
  <button onclick="eroga('coca')">Coca-Cola</button>
  <div class="info" id="cocaInfo"></div>
</div>

<div class="drink">
  <button onclick="eroga('fanta')">Fanta</button>
  <div class="info" id="fantaInfo"></div>
</div>

<div class="drink">
  <button onclick="eroga('lemon')">Lemon Soda</button>
  <div class="info" id="lemonInfo"></div>
</div>

<div class="drink">
  <button onclick="eroga('succoso')">Succoso</button>
  <div class="info" id="succosoInfo"></div>
</div>

<!-- ADMIN RICARICA -->
<div class="admin">
  <h2>Admin · Ricarica</h2>

  <select id="drinkSelect">
    <option value="monster">Monster</option>
    <option value="coca">Coca-Cola</option>
    <option value="fanta">Fanta</option>
    <option value="lemon">Lemon Soda</option>
    <option value="succoso">Succoso</option>
  </select>

  <input type="number" id="qty" placeholder="Numero lattine" min="1">
  <input type="password" id="adminCode" placeholder="Codice admin">
  <button onclick="ricarica()">Ricarica</button>
</div>

<!-- ADMIN STATS -->
<div class="admin">
  <h2>Admin · Statistiche</h2>

  <input type="password" id="statsCode" placeholder="Codice admin">
  <button onclick="openStats()">Accedi</button>

  <div id="statsPanel" class="hidden statsBox">
    <p id="money"></p>
    <p id="soldStats"></p>
    <div class="log" id="log"></div>
  </div>
</div>

<script>
var portionML = 250;
var ADMIN_CODE = "SonoilBoss";
var statsTimer = null;

var drinks = {
  monster: { ml: 500, price: 1.49, cans: 0, sold: 0 },
  coca:    { ml: 330, price: 0.85, cans: 0, sold: 0 },
  fanta:   { ml: 330, price: 0.75, cans: 0, sold: 0 },
  lemon:   { ml: 330, price: 0.55, cans: 0, sold: 0 },
  succoso: { ml: 400, price: 0.60, cans: 0, sold: 0 }
};

var logs = [];

/* CALCOLI */
function portionsAvailable(d) {
  return Math.floor((drinks[d].cans * drinks[d].ml) / portionML);
}

function portionsPerCan(d) {
  return Math.floor(drinks[d].ml / portionML);
}

function pricePerPortion(d) {
  return (drinks[d].price / portionsPerCan(d)).toFixed(2);
}

/* UI */
function updateUI() {
  for (var d in drinks) {
    document.getElementById(d + "Info").innerHTML =
      "Lattine: " + drinks[d].cans +
      " · Porzioni: " + portionsAvailable(d) +
      " · €" + pricePerPortion(d) + " / 25cl";
  }
}

/* EROGA */
function eroga(d) {
  if (portionsAvailable(d) <= 0) {
    alert("Porzioni terminate");
    return;
  }

  drinks[d].sold++;
  drinks[d].cans -= portionML / drinks[d].ml;

  var now = new Date();
  logs.unshift(now.toLocaleTimeString() + " – " + d.toUpperCase());

  updateUI();
}

/* RICARICA */
function ricarica() {
  if (document.getElementById("adminCode").value !== ADMIN_CODE) {
    alert("Codice errato");
    return;
  }

  var qty = parseInt(document.getElementById("qty").value);
  var drink = document.getElementById("drinkSelect").value;

  if (!qty || qty <= 0) {
    alert("Quantità non valida");
    return;
  }

  drinks[drink].cans += qty;
  updateUI();
  alert("Ricarica effettuata");
}

/* STATS */
function openStats() {
  if (document.getElementById("statsCode").value !== ADMIN_CODE) {
    alert("Codice errato");
    return;
  }

  var total = 0;
  var txt = "";

  for (var d in drinks) {
    var gain = drinks[d].sold * pricePerPortion(d);
    total += gain;
    txt += d.toUpperCase() + ": " + drinks[d].sold + " porzioni<br>";
  }

  document.getElementById("money").innerHTML =
    "<b>Incasso totale:</b> €" + total.toFixed(2);
  document.getElementById("soldStats").innerHTML = txt;
  document.getElementById("log").innerHTML = logs.join("<br>");

  var panel = document.getElementById("statsPanel");
  panel.className = "statsBox";

  if (statsTimer) clearTimeout(statsTimer);
  statsTimer = setTimeout(function() {
    panel.className = "hidden statsBox";
  }, 30000);
}

updateUI();
</script>

</body>
</html>
